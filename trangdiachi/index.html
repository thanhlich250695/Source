<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Adtima Accuracy Survey</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
        <meta name="description" content="Description here" />
        <link
            href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700&display=swap&subset=vietnamese"
            rel="stylesheet"
		/>
		<link href="https://fonts.googleapis.com/css2?family=Muli:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet" type="text/css" />
    </head>
    <body class="adtima-survey">
        <div class="ad-survey mastheadPC" style="width:720px; height:1280px;background-image:url(images/img_bg_720x1280.png);background-size:720px 1280px">
            <a class="adtima">
                <img src="images/adtima.png" alt="Adtima" class="img-fluid" />
            </a>
            <div class="container  justify-center align-center" style="max-width: 720px; width: 100%">
                <div class="column-survey flex-grow text-center relaive">
                    <div class="step step1 active">
                        <h1 class="el">Để Adtima nói cho<br> bạn nghe!</h1>
                        <p class="el">
                            Để cải thiện trải nghiệm của bạn, và mang tới nhiều sản phẩm mới tốt hơn, hãy giúp Adtima
                            trả lời một số câu hỏi sau đây nhé. <br />Rất nhanh thôi.
                        </p>
                        <div class="g-button el">
                            <div class="btn action1" id="start">Bắt đầu</div>
                        </div>
                    </div>
                    <div class="step step2 height-city active">
                        <h1 class="el" id="city">Bạn đang sống ở TP.HCM phải không?</h1>
                        <div class="g-button el">
                            <div class="btn btn-vote action2a" id="choose-happy">
                                <i class="icon-happy"></i>
                                Đúng rồi
                            </div>
                            <div class="btn btn-vote action2b" id="choose-sad">
                                <i class="icon-sad"></i>
                                Không phải nha
                            </div>
                            <div class="txt">Chọn đáp án và bấm GỬI</div>
                            <div class="g-button">
                                <div class="btn btn-send">GỬI</div>
                            </div>
                        </div>
                        <img src="images/tphcm.png" alt="Adtima" class="img-fluid pos-city el" />
                    </div>

                    <div class="step step2b">
                        <h1 class="el">Hãy cho biết thành phố<br>bạn đang sống</h1>
                        <div class="g-button el d-flex justify-center">
                            <form action="" method="">
                                <input
                                    id="browsers_input"
                                    list="browsers"
                                    name="browser"
                                    class="f-control text"
                                    placeholder="Chọn tỉnh thành"
                                />
                                <datalist id="browsers">
                                    <option value="TP.HCM"> </option>
                                    <option value="Hà Nội"> </option>
                                    <option value="Vinh"> </option>
                                    <option value="Huế"> </option>
                                    <option value="Đà Nẵng"> </option>
                                </datalist>

                                <div class="btn btn-sunmit action3" id="submit">Gửi</div>
                            </form>
                        </div>
                        <img src="images/tphcm.png" alt="Adtima" class="img-fluid pos-city el" />
                    </div>

                    <div class="step step3">
                        <h1 class="el">Cảm ơn bạn <br> đã dành thời gian <br>giúp Adtima!</h1>
                    </div>
                </div>
            </div>
        </div>

        <script src="js/library.js" type="text/javascript"></script>
        <script>
            var city = "Hồ Chí Minh";
            var yes_anwser = "Yes_HoChiMinh";
            var no_anwser = "No_HoChiMinh";
            var url_link2 = "https://adtima.vn/" ;
            try{
                url_link2 = dynamicData.surveySubmit;
            }catch(e){
                console.log(e);
            }
            
            // "https://px.za.zalo.me/tr?id=3676239907573914899";
            
			anime({ targets: ".column-img", opacity: [0, 1], easing: "easeInOutSine", duration: 1200 });
			anime({
                targets: ".step2 .el",
                opacity: [0, 1],
                delay: function(el, i) {
                    return i * 100;
                },
                easing: "easeInOutSine",
                delay: 350
            });

            var tl1 = anime.timeline({ autoplay: false });
            tl1.add({
                targets: ".step1",
                opacity: [1, 0],
                duration: 250,
                easing: "easeInOutSine",
                changeComplete: function() {
                    removeClass(document.querySelector(".step1"), "active");
                    document.querySelector(".step1").style.display = "none";
                    addClass(document.querySelector(".step2"), "active");
                }
            }).add({
                targets: ".step2 .el",
                opacity: [0, 1],
                delay: function(el, i) {
                    return i * 100;
                },
                autoplay: false,
                easing: "easeInOutSine"
            });
            document.querySelector(".action1").onclick = tl1.play;

            var tl2 = anime.timeline({ autoplay: false });
            tl2.add({
                targets: ".step2",
                opacity: [1, 0],
                duration: 250,
                easing: "easeInOutSine",
                changeComplete: function() {
                    removeClass(document.querySelector(".step2"), "active");
                    document.querySelector(".step2").style.display = "none";
                    document.querySelector(".step2b").style.display = "none";
                    addClass(document.querySelector(".step3"), "active");
                }
            }).add({
                targets: ".step3 .el",
                opacity: [0, 1],
                delay: function(el, i) {
                    return i * 100;
                },
                autoplay: false,
                easing: "easeInOutSine"
            });

            var tl2b = anime.timeline({ autoplay: false });
            tl2b.add({
                targets: ".step2",
                opacity: [1, 0],
                duration: 250,
                easing: "easeInOutSine",
                changeComplete: function() {
                    removeClass(document.querySelector(".step2"), "active");
                    document.querySelector(".step2").style.display = "none";
                    addClass(document.querySelector(".step2b"), "active");
                }
            }).add({
                targets: ".step2b .el",
                opacity: [0, 1],
                delay: function(el, i) {
                    return i * 100;
                },
                autoplay: false,
                easing: "easeInOutSine"
            });

            // document.querySelector(".action2a").onclick = tl2.play;
            // document.querySelector(".action2b").onclick = tl2b.play;

            var tl3 = anime.timeline({ autoplay: false });
            tl3.add({
                targets: ".step2b",
                opacity: [1, 0],
                duration: 250,
                easing: "easeInOutSine",
                changeComplete: function() {
                    removeClass(document.querySelector(".step2b"), "active");
                    document.querySelector(".step2").style.display = "none";
                    document.querySelector(".step2b").style.display = "none";
                    addClass(document.querySelector(".step3"), "active");
                }
            }).add({
                targets: ".step3 .el",
                opacity: [0, 1],
                delay: function(el, i) {
                    return i * 100;
                },
                autoplay: false,
                easing: "easeInOutSine"
            });
            // document.querySelector(".action3").onclick = tl3.play;

            var list_city = [
                {
                    name: "An Giang",
                    ID: "841"
                },
                {
                    name: "Bà Rịa - Vũng Tàu",
                    ID: "842"
                },
                {
                    name: "Bắc Giang",
                    ID: "843"
                },
                {
                    name: "Bắc Kạn",
                    ID: "844"
                },
                {
                    name: "Bạc Liêu",
                    ID: "845"
                },
                {
                    name: "Bắc Ninh",
                    ID: "846"
                },
                {
                    name: "Bến Tre",
                    ID: "847"
                },
                {
                    name: "Bình Định",
                    ID: "848"
                },
                {
                    name: "Bình Dương",
                    ID: "849"
                },
                {
                    name: "Bình Phước",
                    ID: "850"
                },
                {
                    name: "Bình Thuận",
                    ID: "851"
                },
                {
                    name: "Cà Mau",
                    ID: "852"
                },
                {
                    name: "Cần Thơ",
                    ID: "853"
                },
                {
                    name: "Cao Bằng",
                    ID: "854"
                },
                {
                    name: "Đà Nẵng",
                    ID: "855"
                },
                {
                    name: "Đắk Lắk",
                    ID: "856"
                },
                {
                    name: "Đắk Nông",
                    ID: "857"
                },
                {
                    name: "Điện Biên",
                    ID: "858"
                },
                {
                    name: "Đồng Nai",
                    ID: "859"
                },
                {
                    name: "Đồng Tháp",
                    ID: "860"
                },
                {
                    name: "Gia Lai",
                    ID: "861"
                },
                {
                    name: "Hà Giang",
                    ID: "862"
                },
                {
                    name: "Hà Nam",
                    ID: "863"
                },
                {
                    name: "Hà Nội",
                    ID: "864"
                },
                {
                    name: "Hà Tĩnh",
                    ID: "865"
                },
                {
                    name: "Hải Dương",
                    ID: "866"
                },
                {
                    name: "Hải Phòng",
                    ID: "867"
                },
                {
                    name: "Hậu Giang",
                    ID: "868"
                },
                {
                    name: "Hòa Bình",
                    ID: "869"
                },
                {
                    name: "Hưng Yên",
                    ID: "870"
                },
                {
                    name: "Khánh Hòa",
                    ID: "871"
                },
                {
                    name: "Kiên Giang",
                    ID: "872"
                },
                {
                    name: "Kon Tum",
                    ID: "873"
                },
                {
                    name: "Lai Châu",
                    ID: "874"
                },
                {
                    name: "Lâm Đồng",
                    ID: "875"
                },
                {
                    name: "Lạng Sơn",
                    ID: "876"
                },
                {
                    name: "Lào Cai",
                    ID: "877"
                },
                {
                    name: "Long An",
                    ID: "878"
                },
                {
                    name: "Nam Định",
                    ID: "879"
                },
                {
                    name: "Nghệ An",
                    ID: "880"
                },
                {
                    name: "Ninh Bình",
                    ID: "881"
                },
                {
                    name: "Ninh Thuận",
                    ID: "882"
                },
                {
                    name: "Phú Thọ",
                    ID: "883"
                },
                {
                    name: "Phú Yên",
                    ID: "884"
                },
                {
                    name: "Quảng Bình",
                    ID: "885"
                },
                {
                    name: "Quảng Nam",
                    ID: "886"
                },
                {
                    name: "Quảng Ngãi",
                    ID: "887"
                },
                {
                    name: "Quảng Ninh",
                    ID: "888"
                },
                {
                    name: "Quảng Trị",
                    ID: "889"
                },
                {
                    name: "TP HCM",
                    ID: "890"
                },
                {
                    name: "Sóc Trăng",
                    ID: "891"
                },
                {
                    name: "Sơn La",
                    ID: "892"
                },
                {
                    name: "Tây Ninh",
                    ID: "893"
                },
                {
                    name: "Thái Bình",
                    ID: "894"
                },
                {
                    name: "Thái Nguyên",
                    ID: "895"
                },
                {
                    name: "Thanh Hóa",
                    ID: "896"
                },
                {
                    name: "Thừa Thiên Huế",
                    ID: "897"
                },
                {
                    name: "Tiền Giang",
                    ID: "898"
                },
                {
                    name: "Trà Vinh",
                    ID: "899"
                },
                {
                    name: "Tuyên Quang",
                    ID: "900"
                },
                {
                    name: "Vĩnh Long",
                    ID: "901"
                },
                {
                    name: "Vĩnh Phúc",
                    ID: "902"
                },
                {
                    name: "Yên Bái",
                    ID: "903"
                },
                {
                    name: ""
                }
            ];

            var list_city_2 = [];

            document.getElementById("city").innerHTML = "Bạn đang sống ở " + city + " phải không?";

            document.getElementById("start").addEventListener("click", function() {
                //call_tracker(url_link1, "start");
            });

            document.getElementById("choose-happy").addEventListener("click", function() {
                url_link2 = url_link2.replace("__answer__",yes_anwser);
                //call_tracker(url_link2);
            });

            document.getElementById("choose-sad").addEventListener("click", function() {
                //call_tracker(url_link2, "No_HoChiMinh_");
                var item = "";
                for (var i = 0; i < list_city.length; i++) {
                    item =
                        item +
                        '<option value="' +
                        list_city[i]["name"] +
                        '" label="' +
                        removeAccents(list_city[i]["name"]) +
                        '">';
                    list_city_2.push({ id: list_city[i]["id"], name: removeAccents(list_city[i]["name"]) });
                }
                document.getElementById("browsers").innerHTML = item;
            });

            document.getElementById("submit").addEventListener("click", function() {
                var city_name = document.getElementById("browsers_input").value;
                if(city_name!=""){
                    let obj_index = list_city.findIndex(o => o.name === city_name);
                    if (obj_index != -1) {
                        city_name = removeAccents(city_name);
                        city_name = city_name.replace(/\s+/g, "");
                        url_link2 = url_link2.replace("__answer__",no_anwser);
                        url_link2 = url_link2.replace("__content__",city_name);
                        call_tracker(url_link2);
                        tl3.play();
                    }
                }
            });

            function call_tracker(url) {
                var img_tracking = document.createElement("img");
                // img_tracking.src = "" + url + "&event=" + parameters + "&vid=[ZVISITOR]";
                img_tracking.src = url ;
                img_tracking.style.height = "0px";
                img_tracking.style.width = "0px";
                document.body.appendChild(img_tracking);
            }

            function removeAccents(str) {
                var AccentsMap = [
                    "aàảãáạăằẳẵắặâầẩẫấậ",
                    "AÀẢÃÁẠĂẰẲẴẮẶÂẦẨẪẤẬ",
                    "dđ",
                    "DĐ",
                    "eèẻẽéẹêềểễếệ",
                    "EÈẺẼÉẸÊỀỂỄẾỆ",
                    "iìỉĩíị",
                    "IÌỈĨÍỊ",
                    "oòỏõóọôồổỗốộơờởỡớợ",
                    "OÒỎÕÓỌÔỒỔỖỐỘƠỜỞỠỚỢ",
                    "uùủũúụưừửữứự",
                    "UÙỦŨÚỤƯỪỬỮỨỰ",
                    "yỳỷỹýỵ",
                    "YỲỶỸÝỴ"
                ];
                for (var i = 0; i < AccentsMap.length; i++) {
                    var re = new RegExp("[" + AccentsMap[i].substr(1) + "]", "g");
                    var char = AccentsMap[i][0];
                    str = str.replace(re, char);
                }
                return str;
            }
        </script>
        <script src="https://stc.interactive.brand.zing.vn/media/js/default/library/jquery.min.js"></script>
        <script>
            $(document).ready(function(){
				$( "input" ).change(function (){
                    $('.action3').addClass('active');
                    $('select').css('color', 'black');
                })
                $('.btn-vote').click(function(){
                    $('.btn-vote').removeClass('is-active').addClass('is-select');
                    $(this).addClass('is-active');
                    $('.btn-send').addClass('is-active'); 
                })
                $('.btn-send').click(function(){
                    var target = $('.btn-vote.is-active');
                    if(target.hasClass('action2a')){
                        tl2.play();
                        call_tracker(url_link2);
                    }else {
                        tl2b.play();
                    }
                })
            })
        </script>
    </body>
</html>
